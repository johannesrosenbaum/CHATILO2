(this["webpackJsonpchatilo-client"]=this["webpackJsonpchatilo-client"]||[]).push([[0],{167:function(e,t,o){},173:function(e,t,o){"use strict";o.r(t);var n=o(0),a=o.n(n),r=o(125),i=o.n(r),c=(o(167),o(31)),s=o(9),l=o(262),d=o(19),b=o(126),g=o(269),j=o(182),u=o(270),h=o(266),x=o(260),m=o(259),p=o(265),O=o(261),f=o(278),v=o(279),y=o(6),k=o(1);const S=Object(n.createContext)(void 0),w=()=>{const e=Object(n.useContext)(S);if(!e)throw new Error("useAuth must be used within AuthProvider");return e},C=e=>{let{children:t}=e;const[o,a]=Object(n.useState)(null),[r,i]=Object(n.useState)(null),[c,s]=Object(n.useState)(!0),l="http://localhost:1113";Object(n.useEffect)((()=>{(async()=>{const e=localStorage.getItem("token");if(e){console.log("\ud83d\udd10 Checking stored token: Token found"),i(e);try{console.log("\ud83d\udc64 Fetching user data...");const t=await fetch("".concat(l,"/api/auth/me"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();console.log("\u2705 User data received:",e);const o={id:e.id||e._id,_id:e._id||e.id,username:e.username,email:e.email,bio:e.bio,avatar:e.avatar,locationEnabled:e.locationEnabled||!1,notificationsEnabled:!1!==e.notificationsEnabled,isActive:e.isActive||!0,lastSeen:e.lastSeen||(new Date).toISOString(),createdAt:e.createdAt||(new Date).toISOString(),updatedAt:e.updatedAt||(new Date).toISOString()};a(o)}else console.warn("\u26a0\ufe0f Token invalid, clearing storage"),localStorage.removeItem("token"),i(null),a(null),console.log("\u26a0\ufe0f Please login again")}catch(t){console.error("\u274c Error fetching user data:",t),localStorage.removeItem("token"),i(null),a(null)}}s(!1)})()}),[l]);const d=Object(n.useCallback)((async(e,t)=>{try{s(!0),console.log("\ud83d\udd10 Attempting login for:",e);const o=await fetch("".concat(l,"/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),n=await o.json();if(o.ok){console.log("\u2705 Login successful, storing token"),localStorage.setItem("token",n.token),i(n.token);const e={id:n.user._id||n.user.id,_id:n.user._id||n.user.id,username:n.user.username,email:n.user.email,bio:n.user.bio,avatar:n.user.avatar,locationEnabled:n.user.locationEnabled||!1,notificationsEnabled:!1!==n.user.notificationsEnabled,isActive:n.user.isActive||!0,lastSeen:n.user.lastSeen||(new Date).toISOString(),createdAt:n.user.createdAt||(new Date).toISOString(),updatedAt:n.user.updatedAt||(new Date).toISOString()};return a(e),s(!1),!0}return console.error("\u274c Login failed:",n.message),s(!1),!1}catch(o){return console.error("\u274c Login error:",o.message),s(!1),!1}}),[l]),b=Object(n.useCallback)((()=>{console.log("\ud83d\udeaa Logging out user"),localStorage.removeItem("token"),i(null),a(null),s(!1)}),[]),g=Object(n.useCallback)((async e=>{try{console.log("\ud83d\udcdd Updating user profile:",e);const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const o=await fetch("".concat(l,"/api/auth/profile"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)});if(o.ok){const e=await o.json();return console.log("\u2705 Profile updated successfully:",e),a(e.user||e),!0}{const e=await o.json();return console.error("\u274c Profile update failed:",e),!1}}catch(t){return console.error("\u274c Error updating profile:",t),!1}}),[l]),j={user:o,token:r,loading:c,login:d,register:async(e,t,o)=>{console.log("\ud83d\udcdd Attempting registration for:",t);try{s(!0);const n=await fetch("".concat(l,"/api/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:t,password:o})}),r=await n.json();if(n.ok){console.log("\u2705 Registration successful, storing token"),localStorage.setItem("token",r.token),i(r.token);const e={id:r.user._id||r.user.id,_id:r.user._id||r.user.id,username:r.user.username,email:r.user.email,bio:r.user.bio,avatar:r.user.avatar,locationEnabled:r.user.locationEnabled||!0,notificationsEnabled:!1!==r.user.notificationsEnabled,isActive:r.user.isActive||!0,lastSeen:r.user.lastSeen||(new Date).toISOString(),createdAt:r.user.createdAt||(new Date).toISOString(),updatedAt:r.user.updatedAt||(new Date).toISOString()};return a(e),s(!1),r}throw s(!1),new Error(r.message||"Registration failed")}catch(n){throw console.error("\u274c Registration error:",n.message),s(!1),n}},logout:b,updateUser:g};return Object(k.jsx)(S.Provider,{value:j,children:t})},I=["children","value","index"],E=Object(y.a)("div")((e=>{let{theme:t}=e;return{width:80,height:80,borderRadius:"20px",background:"linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 8px 32px rgba(255, 255, 255, 0.4)",border:"3px solid rgba(102, 126, 234, 0.2)",position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(45deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.4) 100%)",borderRadius:"17px"}}})),R=Object(y.a)("div")((e=>{let{theme:t}=e;return{fontSize:"48px",fontWeight:900,background:"linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",fontFamily:'"Inter", sans-serif',position:"relative",zIndex:1}})),D=Object(y.a)(g.a)((e=>{let{theme:t}=e;return{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%)",backgroundSize:"400% 400%",animation:"gradientShift 8s ease infinite",display:"flex",alignItems:"center",justifyContent:"center",padding:t.spacing(2),"@keyframes gradientShift":{"0%":{backgroundPosition:"0% 50%"},"50%":{backgroundPosition:"100% 50%"},"100%":{backgroundPosition:"0% 50%"}}}})),A=Object(y.a)(j.a)((e=>{let{theme:t}=e;return{fontWeight:900,fontSize:"3rem",background:"linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",textAlign:"center",marginBottom:t.spacing(1),letterSpacing:"1px",textShadow:"0 2px 10px rgba(102, 126, 234, 0.3)"}})),T=Object(y.a)(u.a)((e=>{let{theme:t}=e;return{background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(248,250,252,0.95) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:24,padding:t.spacing(4),boxShadow:"0 20px 60px rgba(102, 126, 234, 0.3)",maxWidth:450,width:"100%",position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",borderRadius:24,pointerEvents:"none"}}})),W=Object(y.a)(h.a)((e=>{let{theme:t}=e;return{background:"linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%)",backgroundSize:"200% 200%",border:"none",borderRadius:12,color:"white",fontWeight:700,fontSize:"1.1rem",padding:"12px 24px",textTransform:"none",boxShadow:"0 8px 20px rgba(102, 126, 234, 0.4)",transition:"all 0.3s ease","&:hover":{backgroundPosition:"100% 0",transform:"translateY(-2px)",boxShadow:"0 12px 30px rgba(102, 126, 234, 0.5)"},"&:active":{transform:"translateY(0px)"}}})),z=Object(y.a)(x.a)((e=>{let{theme:t}=e;return{marginBottom:t.spacing(3),"& .MuiTabs-indicator":{background:"linear-gradient(135deg, #667eea 0%, #f093fb 100%)",height:3,borderRadius:2},"& .MuiTab-root":{textTransform:"none",fontWeight:600,fontSize:"1rem",color:t.palette.text.secondary,"&.Mui-selected":{background:"linear-gradient(135deg, #667eea 0%, #f093fb 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"}}}})),P=Object(y.a)(m.a)((e=>{let{theme:t}=e;return{marginBottom:t.spacing(2),"& .MuiOutlinedInput-root":{borderRadius:12,background:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(10px)","&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#667eea"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#667eea",boxShadow:"0 0 0 3px rgba(102, 126, 234, 0.1)"}},"& .MuiInputLabel-root.Mui-focused":{color:"#667eea"}}}));function M(e){const{children:t,value:o,index:n}=e,a=Object(b.a)(e,I);return Object(k.jsx)("div",Object(d.a)(Object(d.a)({role:"tabpanel",hidden:o!==n,id:"tabpanel-".concat(n)},a),{},{children:o===n&&Object(k.jsx)(g.a,{children:t})}))}var L=()=>{const[e,t]=Object(n.useState)(0),[o,a]=Object(n.useState)(!1),[r,i]=Object(n.useState)(null),[c,l]=Object(n.useState)(null),[d,b]=Object(n.useState)(""),[u,h]=Object(n.useState)(""),[x,m]=Object(n.useState)(""),[y,S]=Object(n.useState)(""),[C,I]=Object(n.useState)(""),{login:L,register:B}=w(),U=Object(s.q)();return Object(k.jsx)(D,{children:Object(k.jsx)(p.a,{maxWidth:"sm",children:Object(k.jsxs)(T,{elevation:0,children:[Object(k.jsxs)(g.a,{textAlign:"center",mb:4,children:[Object(k.jsxs)(g.a,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:2,mb:2},children:[Object(k.jsx)(E,{children:Object(k.jsx)(R,{children:"C"})}),Object(k.jsx)(A,{variant:"h2",sx:{mb:0},children:"CHATILO"})]}),Object(k.jsx)(j.a,{variant:"h6",color:"text.secondary",sx:{fontWeight:500,opacity:.8,mb:2},children:"Verbinde dich mit deiner Community"})]}),r&&Object(k.jsx)(O.a,{severity:"error",sx:{mb:3,borderRadius:3},children:r}),c&&Object(k.jsx)(O.a,{severity:"success",sx:{mb:3,borderRadius:3},children:c}),Object(k.jsxs)(z,{value:e,onChange:(e,o)=>{t(o),i(null),l(null)},centered:!0,children:[Object(k.jsx)(f.a,{label:"Anmelden"}),Object(k.jsx)(f.a,{label:"Registrieren"})]}),Object(k.jsx)(M,{value:e,index:0,children:Object(k.jsxs)(g.a,{component:"form",onSubmit:async e=>{e.preventDefault(),a(!0),i(null);try{await L(d,u)&&(l("Login erfolgreich! Weiterleitung..."),setTimeout((()=>{U("/chat")}),1e3))}catch(r){i(r.message||"Login fehlgeschlagen")}finally{a(!1)}},children:[Object(k.jsx)(P,{fullWidth:!0,label:"E-Mail",type:"email",value:d,onChange:e=>b(e.target.value),required:!0,disabled:o}),Object(k.jsx)(P,{fullWidth:!0,label:"Passwort",type:"password",value:u,onChange:e=>h(e.target.value),required:!0,disabled:o}),Object(k.jsx)(W,{type:"submit",fullWidth:!0,size:"large",disabled:o,sx:{mt:2},children:o?Object(k.jsx)(v.a,{size:24,color:"inherit"}):"Anmelden"})]})}),Object(k.jsx)(M,{value:e,index:1,children:Object(k.jsxs)(g.a,{component:"form",onSubmit:async e=>{e.preventDefault(),a(!0),i(null);try{await B(x,y,C)&&(l("Registrierung erfolgreich! Weiterleitung..."),setTimeout((()=>{U("/chat")}),1e3))}catch(r){i(r.message||"Registrierung fehlgeschlagen")}finally{a(!1)}},children:[Object(k.jsx)(P,{fullWidth:!0,label:"Benutzername",value:x,onChange:e=>m(e.target.value),required:!0,disabled:o}),Object(k.jsx)(P,{fullWidth:!0,label:"E-Mail",type:"email",value:y,onChange:e=>S(e.target.value),required:!0,disabled:o}),Object(k.jsx)(P,{fullWidth:!0,label:"Passwort",type:"password",value:C,onChange:e=>I(e.target.value),required:!0,disabled:o}),Object(k.jsx)(W,{type:"submit",fullWidth:!0,size:"large",disabled:o,sx:{mt:2},children:o?Object(k.jsx)(v.a,{size:24,color:"inherit"}):"Registrieren"})]})}),Object(k.jsx)(g.a,{textAlign:"center",mt:4,children:Object(k.jsx)(j.a,{variant:"caption",color:"text.secondary",children:"Willkommen bei CHATILO - Deinem lokalen Chat-Netzwerk"})})]})})})},B=o(280),U=o(281),F=o(271);const N=Object(y.a)(B.a)((e=>{let{theme:t}=e;return{background:"linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(248,250,252,0.9) 100%)",backdropFilter:"blur(10px)",borderRadius:20,border:"1px solid rgba(102, 126, 234, 0.1)",boxShadow:"0 8px 32px rgba(102, 126, 234, 0.1)"}})),_=Object(y.a)(h.a)((e=>{let{theme:t}=e;return{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",borderRadius:12,padding:"12px 24px",fontWeight:600,textTransform:"none","&:hover":{background:"linear-gradient(135deg, #764ba2 0%, #667eea 100%)",transform:"translateY(-2px)",boxShadow:"0 6px 20px rgba(102, 126, 234, 0.4)"}}}));var G=()=>{const[e,t]=Object(n.useState)({username:"",email:"",password:"",confirmPassword:""}),[o,a]=Object(n.useState)(""),[r,i]=Object(n.useState)(!1),{register:c}=w(),l=Object(s.q)(),b=e=>{t((t=>Object(d.a)(Object(d.a)({},t),{},{[e.target.name]:e.target.value})))};return Object(k.jsx)(g.a,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%)",p:3},children:Object(k.jsx)(N,{sx:{maxWidth:400,width:"100%"},children:Object(k.jsxs)(U.a,{sx:{p:4},children:[Object(k.jsx)(j.a,{variant:"h4",component:"h1",gutterBottom:!0,textAlign:"center",sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",fontWeight:700,mb:3},children:"CHATILO"}),Object(k.jsx)(j.a,{variant:"body1",textAlign:"center",color:"text.secondary",sx:{mb:3},children:"Erstelle dein Konto"}),o&&Object(k.jsx)(O.a,{severity:"error",sx:{mb:2},children:o}),Object(k.jsxs)(g.a,{component:"form",onSubmit:async t=>{if(t.preventDefault(),e.password===e.confirmPassword){i(!0),a("");try{await c(e.username,e.email,e.password),l("/chat")}catch(o){a(o.message||"Registrierung fehlgeschlagen")}finally{i(!1)}}else a("Passw\xf6rter stimmen nicht \xfcberein")},children:[Object(k.jsx)(m.a,{fullWidth:!0,name:"username",label:"Benutzername",value:e.username,onChange:b,margin:"normal",required:!0,disabled:r}),Object(k.jsx)(m.a,{fullWidth:!0,name:"email",label:"E-Mail",type:"email",value:e.email,onChange:b,margin:"normal",required:!0,disabled:r}),Object(k.jsx)(m.a,{fullWidth:!0,name:"password",label:"Passwort",type:"password",value:e.password,onChange:b,margin:"normal",required:!0,disabled:r}),Object(k.jsx)(m.a,{fullWidth:!0,name:"confirmPassword",label:"Passwort best\xe4tigen",type:"password",value:e.confirmPassword,onChange:b,margin:"normal",required:!0,disabled:r}),Object(k.jsx)(_,{type:"submit",fullWidth:!0,size:"large",disabled:r,sx:{mt:3,mb:2},children:r?Object(k.jsx)(v.a,{size:24,color:"inherit"}):"Registrieren"}),Object(k.jsx)(g.a,{textAlign:"center",children:Object(k.jsxs)(j.a,{variant:"body2",color:"text.secondary",children:["Bereits ein Konto?"," ",Object(k.jsx)(F.a,{href:"/login",sx:{color:"primary.main",fontWeight:600,textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Anmelden"})]})})]})]})})})},q=o(27),J=o(250),Y=o(274),H=o(291),V=o(292),K=o(277),Z=o(129),X=o.n(Z),Q=o(258),$=o(272),ee=o(276),te=o(282),oe=o(240),ne=o(284),ae=o(267),re=o(285),ie=o(286),ce=o(287),se=o(288),le=o(244),de=o(289),be=o(290),ge=o(235),je=o(236),ue=o(237),he=o(238),xe=o(239),me=o(241),pe=o(242),Oe=o(243),fe=o(245),ve=o(135);const ye=Object(n.createContext)(void 0),ke=()=>{const e=Object(n.useContext)(ye);if(void 0===e)throw new Error("useSocket must be used within a SocketProvider");return e},Se=e=>{let{children:t}=e;console.log("\ud83d\udd27 DEBUG: SocketProvider initializing...");const{user:o}=w(),{roomId:a}=Object(s.s)();console.log("\ud83d\udd27 DEBUG: SocketProvider - Initial user:",o),console.log("\ud83d\udd27 DEBUG: SocketProvider - URL room ID:",a);const[r,i]=Object(n.useState)(null),[c,l]=Object(n.useState)(null),[b,g]=Object(n.useState)([]),[j,u]=Object(n.useState)([]),[h,x]=Object(n.useState)([]),[m,p]=Object(n.useState)(null),[O,f]=Object(n.useState)("Unknown Location"),[v,y]=Object(n.useState)(!1),[S,C]=Object(n.useState)(null),I="http://localhost:1113";console.log("\ud83d\udd27 DEBUG: SocketProvider - Socket URL:",I),console.log("\ud83d\udd27 DEBUG: SocketProvider - Expected Frontend Port: 1234"),console.log("\ud83d\udd27 DEBUG: SocketProvider - Expected Backend Port: 1113");const E=Object(n.useCallback)((async(e,t)=>{try{const o=await fetch("https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=".concat(e,"&longitude=").concat(t,"&localityLanguage=en")),n=await o.json(),a=n.city||n.locality||n.principalSubdivision||"Unknown Location";f(a),console.log("\ud83d\udccd Location name updated: ".concat(a))}catch(o){console.error("\u274c Error fetching location name:",o),f("Unknown Location")}}),[]),R=Object(n.useCallback)((async(e,t)=>{try{const o=localStorage.getItem("token");if(!o)return void console.log("\u23f3 No token available for nearby rooms fetch");const n=await fetch("".concat("http://localhost:1113","/api/chat/rooms/nearby"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify({latitude:e,longitude:t,radius:1e4})});if(n.ok){const e=await n.json();console.log("\ud83c\udfe0 Found ".concat(e.length," nearby rooms")),x(e)}else console.error("\u274c Failed to fetch nearby rooms:",n.status)}catch(o){console.error("\u274c Error fetching nearby rooms:",o)}}),[]),D=Object(n.useCallback)((()=>{if(!navigator.geolocation)return void console.error("\u274c Geolocation not supported");if(v)return void console.log("\u23f3 Location already loading, skipping...");y(!0),navigator.geolocation.getCurrentPosition((e=>{const{latitude:t,longitude:o,accuracy:n}=e.coords;console.log("\ud83d\udccd PROGRESSIVE update: accuracy ".concat(n,"m, coords: ").concat(t,", ").concat(o));p({latitude:t,longitude:o}),C(n),y(!1),E(t,o),R(t,o)}),(e=>{console.error("\u274c Geolocation error:",e.message),y(!1)}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})}),[E,R,v]),A=Object(n.useCallback)((()=>{if((null===o||void 0===o||!o._id)&&(null===o||void 0===o||!o.id))return null;console.log("\ud83d\udd17 Connecting simple chat for: ".concat(o.username));const e=Object(ve.a)(I,{transports:["websocket","polling"],timeout:2e4,autoConnect:!0});return e.on("connect",(()=>{console.log("\u2705 Socket connected"),o&&e.emit("auth",{userId:o._id||o.id,username:o.username})})),e.on("disconnect",(e=>{console.log("\ud83d\udd0c Socket disconnected:",e)})),e.on("auth-success",(()=>{console.log("\u2705 Simple auth successful")})),e.on("newMessage",(e=>{console.log("\ud83d\udcec New message received:",e),g((t=>t.some((t=>t._id===e._id||t.id===e.id))?t:[...t,e]))})),e.on("joined-room",(e=>{console.log("\u2705 Joined room confirmed:",e),l(e.roomId),g(e.messages||[]),x((t=>t.map((t=>t._id===e.roomId||t.id===e.roomId?Object(d.a)(Object(d.a)({},t),{},{participants:e.userCount}):t))))})),e.on("joinedRoom",(e=>{console.log("\u2705 Joined room confirmed via joinedRoom:",e),l(e.roomId),g(e.messages||[]),x((t=>t.map((t=>t._id===e.roomId||t.id===e.roomId?Object(d.a)(Object(d.a)({},t),{},{participants:e.userCount}):t))))})),e.on("roomMessages",(e=>{console.log("\u2705 Room messages received via roomMessages:",e),g(e||[])})),e.on("room-joined",(e=>{console.log("\u2705 Joined room confirmed via room-joined:",e),l(e.roomId),g(e.messages||[])})),e.on("messages-loaded",(e=>{console.log("\u2705 Messages loaded via messages-loaded:",e),g(e||[])})),e.on("room-data",(e=>{console.log("\u2705 Room data received via room-data:",e),l(e.roomId),g(e.messages||[])})),e.on("userCountUpdate",(e=>{console.log("\ud83d\udc65 User count updated:",e),x((t=>t.map((t=>t._id===e.roomId||t.id===e.roomId?Object(d.a)(Object(d.a)({},t),{},{participants:e.userCount}):t))))})),console.log("\u2705 ALL socket event listeners registered successfully!"),i(e),e}),[o,I]),T=Object(n.useCallback)((e=>{if(console.log("\ud83d\udeaa Joining room:",e),r)console.log("\ud83d\ude80 EMITTING join-room event to Simple Chat Server"),r.emit("join-room",e),l(e);else{const t=A();setTimeout((()=>{console.log("\ud83d\ude80 EMITTING join-room event after socket creation"),null===t||void 0===t||t.emit("join-room",e)}),1e3)}}),[r,A]),W=Object(n.useCallback)((e=>{if(console.log("\ud83d\udd27 DEBUG: sendMessage called with content:",e),console.log("\ud83d\udd27 DEBUG: Socket available:",!!r),console.log("\ud83d\udd27 DEBUG: Current room:",c),console.log("\ud83d\udd27 DEBUG: Socket connected:",null===r||void 0===r?void 0:r.connected),console.log("\ud83d\udd27 DEBUG: User info:",{id:null===o||void 0===o?void 0:o.id,username:null===o||void 0===o?void 0:o.username}),!r||!c)return console.error("\u274c DETAILED ERROR: Missing requirements"),console.error("   - Socket exists:",!!r),console.error("   - Socket connected:",null===r||void 0===r?void 0:r.connected),console.error("   - Current room:",c),void console.error("   - User ID:",(null===o||void 0===o?void 0:o.id)||(null===o||void 0===o?void 0:o._id));const t={content:e.trim(),chatRoom:c,timestamp:(new Date).toISOString(),debug:{userId:(null===o||void 0===o?void 0:o.id)||(null===o||void 0===o?void 0:o._id),username:null===o||void 0===o?void 0:o.username,socketId:null===r||void 0===r?void 0:r.id,timestamp:Date.now()}};console.log("\ud83d\udce4 DETAILED Message data:"),console.log("   Content:",t.content),console.log("   ChatRoom:",t.chatRoom),console.log("   Timestamp:",t.timestamp),console.log("   Debug info:",t.debug),console.log("   Full object:",JSON.stringify(t,null,2)),console.log("\ud83d\ude80 Emitting sendMessage event...");try{r.emit("sendMessage",t),console.log("\u2705 sendMessage event emitted successfully")}catch(n){console.error("\u274c Error emitting sendMessage:",n)}}),[r,c,o]),z=Object(n.useCallback)((async e=>(console.log("\ud83c\udf89 Creating event room:",e),null)),[]),P=Object(n.useCallback)((async e=>{console.log("\ud83d\udc4d Liking message:",e)}),[]),M={socket:r,currentRoom:c,userLocation:m,currentLocationName:O,isLocationLoading:v,locationAccuracy:S,joinRoom:T,sendMessage:W,messages:b,rooms:j,chatRooms:h,setRooms:u,setCurrentRoom:l,setMessages:g,user:o,createEventRoom:z,likeMessage:P};return Object(n.useEffect)((()=>{if(null!==o&&void 0!==o&&o.id&&!r){console.log("\ud83d\udd17 Initiating socket connection...");const e=setTimeout((()=>{A()}),500);return()=>clearTimeout(e)}return()=>{r&&(console.log("\ud83d\udd0c Disconnecting socket..."),r.disconnect())}}),[o,r,A]),Object(n.useEffect)((()=>{if(null===o||void 0===o||!o.locationEnabled)return;console.log("\ud83d\udccd Starting IMMEDIATE location detection...");const e=()=>{const t=localStorage.getItem("token");!t||m||v?t?console.log("\ud83d\udd04 Location already loading or available"):(console.log("\u23f3 No token yet, retrying in 1s..."),setTimeout(e,1e3)):(console.log("\ud83d\ude80 Token found! Triggering getCurrentLocation immediately"),D())},t=setTimeout(e,100);return()=>clearTimeout(t)}),[null===o||void 0===o?void 0:o.locationEnabled,D]),Object(n.useEffect)((()=>{a&&r&&a!==c&&(console.log("\ud83d\udeaa Auto-joining room from URL: ".concat(a)),T(a))}),[a,r,c,T]),Object(n.useEffect)((()=>{if(!r)return void console.log("\ud83d\udd27 DEBUG: No socket for message listener");console.log("\ud83d\udd27 DEBUG: Setting up message listeners");const e=e=>{var t;if(console.log("\ud83d\udce8 DETAILED Received newMessage:"),console.log("   Full message object:",JSON.stringify(e,null,2)),console.log("   Message ID:",e._id),console.log("   Content:",e.content),console.log("   Sender:",e.sender),console.log("   ChatRoom:",e.chatRoom),console.log("   Timestamp:",e.timestamp),!e.sender)return console.error("\u274c DETAILED: Invalid message structure"),console.error("   Missing sender in message:",e),void console.error("   Available keys:",Object.keys(e));const o={_id:e._id,id:e._id,content:e.content,userId:e.sender._id||e.sender.id,username:e.sender.username,timestamp:new Date(e.timestamp||e.createdAt),createdAt:new Date(e.timestamp||e.createdAt),roomId:(null===(t=e.chatRoom)||void 0===t?void 0:t._id)||e.chatRoom,sender:e.sender,type:"text"};console.log("\u2705 FORMATTED message:"),console.log("   Formatted object:",JSON.stringify(o,null,2)),g((e=>{console.log("\ud83d\udd27 DEBUG: Current messages count:",e.length);const t=e.some((e=>e._id===o._id));if(console.log("\ud83d\udd27 DEBUG: Is duplicate?",t),t)return console.log("\u26a0\ufe0f Skipping duplicate message:",o._id),e;const n=[...e,o];return console.log("\u2705 Adding new message. New count:",n.length),n}))},t=e=>{console.error("\u274c DETAILED Socket error:"),console.error("   Error object:",e),console.error("   Error message:",e.message),console.error("   Error details:",e.details),console.error("   Error code:",e.code),console.error("   Full error:",JSON.stringify(e,null,2)),e.message&&alert("Chat Fehler: ".concat(e.message))},o=e=>{console.log("\u2705 DETAILED Message sent confirmation:"),console.log("   Confirmation data:",JSON.stringify(e,null,2)),console.log("   Success:",e.success),console.log("   Message ID:",e.messageId)},n=()=>{console.log("\ud83d\udd17 DETAILED Socket connected:"),console.log("   Socket ID:",r.id),console.log("   Socket connected:",r.connected),console.log("   Socket transport:",r.io.engine.transport.name)},a=e=>{console.log("\ud83d\udd0c DETAILED Socket disconnected:"),console.log("   Reason:",e),console.log("   Socket ID:",r.id)};return r.on("newMessage",e),r.on("error",t),r.on("messageSent",o),r.on("connect",n),r.on("disconnect",a),console.log("\u2705 All message listeners registered with debugging"),()=>{console.log("\ud83d\udd27 DEBUG: Cleaning up message listeners"),r.off("newMessage",e),r.off("error",t),r.off("messageSent",o),r.off("connect",n),r.off("disconnect",a)}}),[r]),console.log("\ud83d\udd27 DEBUG: SocketProvider fully initialized"),Object(k.jsx)(ye.Provider,{value:M,children:t})};var we=()=>{const{rooms:e,chatRooms:t,joinRoom:o,userLocation:a,currentLocationName:r,isLocationLoading:i,locationAccuracy:c,createEventRoom:l}=ke(),[b,u]=Object(n.useState)(!1),[x,p]=Object(n.useState)(""),[O,f]=Object(n.useState)(""),[y,S]=Object(n.useState)(""),[w,C]=Object(n.useState)(""),I=Object(s.q)(),{roomId:E}=Object(s.s)(),R=e=>{const t=e._id||e.id;return t||(console.warn("\u26a0\ufe0f Room without valid ID:",e),"unknown-room")},D=e=>{console.log("\ud83d\udeaa Navigating to room:",e),o(e),I("/chat/".concat(e))},A=e&&e.length>0?e:t,T=(e,t)=>{switch(e){case"location":return"regional"===t?Object(k.jsx)(ge.a,{color:"primary"}):"city"===t?Object(k.jsx)(je.a,{color:"primary"}):"neighborhood"===t?Object(k.jsx)(ue.a,{color:"secondary"}):Object(k.jsx)(je.a,{color:"primary"});case"event":return Object(k.jsx)(he.a,{color:"secondary"});case"global":return Object(k.jsx)(ge.a,{color:"action"});default:return Object(k.jsx)(ue.a,{})}},W=(null===A||void 0===A?void 0:A.map(((e,t)=>{console.log("\ud83d\udd0d Processing room:",e.name,"participants:",e.participants,"distance:",e.distance,"type:",e.type,"subType:",e.subType);return Object(d.a)(Object(d.a)({},e),{},{id:R(e),type:e.type||"location",subType:e.subType||"neighborhood",participants:e.participants||0,distance:e.distance||0,event:e.event||void 0,description:e.description||void 0,location:e.location?{type:e.location.type||"Point",coordinates:e.location.coordinates||[e.location.longitude||0,e.location.latitude||0],address:e.location.address,city:e.location.city,radius:e.location.radius,latitude:e.location.latitude,longitude:e.location.longitude}:void 0})})))||[];console.log("\ud83d\udd04 Converted rooms:",W.length,W.map((e=>"".concat(e.name," (type: ").concat(e.type,", subType: ").concat(e.subType,")"))));const z=W.filter((e=>"location"===e.type)),P=z.filter((e=>"regional"===e.subType)),M=z.filter((e=>"city"===e.subType)),L=W.filter((e=>"event"===e.type)),B=W.filter((e=>"global"===e.type)),U=z;return console.log("\ud83c\udfd7\ufe0f After type filtering:"),console.log("   Local rooms:",z.length,z.map((e=>e.name))),console.log("   Event rooms:",L.length),console.log("   Global rooms:",B.length),Object(k.jsxs)(g.a,{sx:{height:"100vh",display:"flex",flexDirection:"column",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:[Object(k.jsxs)(g.a,{sx:{p:2,borderBottom:"1px solid rgba(255,255,255,0.2)",background:"rgba(255,255,255,0.1)",backdropFilter:"blur(10px)"},children:[Object(k.jsxs)(g.a,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1},children:[Object(k.jsx)(j.a,{variant:"h6",sx:{fontWeight:"bold",background:"linear-gradient(135deg, #ffffff 0%, #f0f0f0 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"CHATILO \ud83d\ude80"}),a&&Object(k.jsx)(Q.a,{title:"Standort aktiv",children:Object(k.jsx)(xe.a,{color:"success",fontSize:"small"})})]}),i&&Object(k.jsxs)(g.a,{sx:{display:"flex",alignItems:"center",mb:1},children:[Object(k.jsx)(v.a,{size:16,sx:{mr:1,color:"white"}}),Object(k.jsx)(j.a,{variant:"body2",sx:{color:"rgba(255,255,255,0.8)"},children:"Standort wird ermittelt..."})]}),r&&!i&&Object(k.jsxs)(g.a,{sx:{display:"flex",alignItems:"center",mb:1},children:[Object(k.jsx)(je.a,{sx:{fontSize:16,mr:.5,color:"white"}}),Object(k.jsx)(j.a,{variant:"body2",sx:{color:"rgba(255,255,255,0.8)"},children:r}),c&&Object(k.jsx)($.a,{label:"\xb1".concat(Math.round(c),"m"),size:"small",sx:{ml:1,fontSize:"0.6rem",height:16,backgroundColor:"rgba(255,255,255,0.2)",color:"white"},color:c<=100?"success":c<=500?"warning":"default"})]}),0===W.length&&!i&&Object(k.jsxs)(g.a,{sx:{display:"flex",alignItems:"center",mb:1},children:[Object(k.jsx)(v.a,{size:16,sx:{mr:1,color:"white"}}),Object(k.jsx)(j.a,{variant:"body2",sx:{color:"rgba(255,255,255,0.7)"},children:"Chat-R\xe4ume werden geladen..."})]})]}),Object(k.jsxs)(g.a,{sx:{flex:1,overflow:"auto",background:"rgba(255,255,255,0.05)",backdropFilter:"blur(20px)"},children:[P.length>0&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(g.a,{sx:{p:2,pb:1},children:Object(k.jsxs)(j.a,{variant:"subtitle2",sx:{fontWeight:"bold",color:"white"},children:["\ud83c\udf0d Regional (",P.length,")"]})}),Object(k.jsx)(ee.a,{dense:!0,children:P.map(((e,t)=>Object(k.jsx)(te.a,{disablePadding:!0,children:Object(k.jsxs)(oe.a,{selected:E===R(e),onClick:()=>D(R(e)),sx:{borderRadius:1,mx:1,mb:.5,background:E===R(e)?"linear-gradient(135deg, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0.1) 100%)":"rgba(255,255,255,0.1)","&:hover":{background:"linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%)",transform:"translateY(-2px)"},transition:"all 0.3s ease",color:"white"},children:[Object(k.jsx)(ne.a,{children:Object(k.jsx)(ae.a,{badgeContent:e.participants,color:"primary",children:T(e.type,e.subType)})}),Object(k.jsx)(re.a,{primary:e.name,secondary:Object(k.jsxs)(g.a,{component:"div",sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[Object(k.jsxs)(g.a,{component:"div",sx:{display:"flex",alignItems:"center",gap:.5},children:[Object(k.jsx)(me.a,{fontSize:"small"}),Object(k.jsxs)(j.a,{component:"span",variant:"caption",children:[e.participants||0," online"]})]}),void 0!==e.distance&&null!==e.distance&&Object(k.jsx)($.a,{label:"".concat(e.distance,"km"),size:"small",variant:"outlined",sx:{height:16,fontSize:"0.7rem",borderColor:"rgba(255,255,255,0.5)",color:"white"}})]})})]})},"regional-".concat(R(e),"-").concat(t))))}),Object(k.jsx)(ie.a,{sx:{my:1,borderColor:"rgba(255,255,255,0.2)"}})]}),M.length>0&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(g.a,{sx:{p:2,pb:1},children:Object(k.jsxs)(j.a,{variant:"subtitle2",sx:{fontWeight:"bold",color:"white"},children:["\ud83c\udfd9\ufe0f Stadt (",M.length,")"]})}),Object(k.jsx)(ee.a,{dense:!0,children:M.map(((e,t)=>Object(k.jsx)(te.a,{disablePadding:!0,children:Object(k.jsxs)(oe.a,{selected:E===R(e),onClick:()=>D(R(e)),sx:{borderRadius:1,mx:1,mb:.5,background:E===R(e)?"linear-gradient(135deg, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0.1) 100%)":"rgba(255,255,255,0.1)","&:hover":{background:"linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%)",transform:"translateY(-2px)"},transition:"all 0.3s ease",color:"white"},children:[Object(k.jsx)(ne.a,{children:Object(k.jsx)(ae.a,{badgeContent:e.participants,color:"primary",children:T(e.type,e.subType)})}),Object(k.jsx)(re.a,{primary:e.name,secondary:Object(k.jsxs)(g.a,{component:"div",sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[Object(k.jsxs)(g.a,{component:"div",sx:{display:"flex",alignItems:"center",gap:.5},children:[Object(k.jsx)(me.a,{fontSize:"small"}),Object(k.jsxs)(j.a,{component:"span",variant:"caption",children:[e.participants||0," online"]})]}),void 0!==e.distance&&null!==e.distance&&Object(k.jsx)($.a,{label:"".concat(e.distance,"km"),size:"small",variant:"outlined",sx:{height:16,fontSize:"0.7rem",borderColor:"rgba(255,255,255,0.5)",color:"white"}})]})})]})},"city-".concat(R(e),"-").concat(t))))}),Object(k.jsx)(ie.a,{sx:{my:1,borderColor:"rgba(255,255,255,0.2)"}})]}),U.length>0&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(g.a,{sx:{p:2,pb:1},children:Object(k.jsxs)(j.a,{variant:"subtitle2",sx:{fontWeight:"bold",color:"white"},children:["\ud83c\udfd8\ufe0f Nachbarschaft (",U.length,")"]})}),Object(k.jsx)(ee.a,{dense:!0,children:U.map(((e,t)=>Object(k.jsx)(te.a,{disablePadding:!0,children:Object(k.jsxs)(oe.a,{selected:E===R(e),onClick:()=>D(R(e)),sx:{borderRadius:1,mx:1,mb:.5,background:E===R(e)?"linear-gradient(135deg, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0.1) 100%)":"rgba(255,255,255,0.1)","&:hover":{background:"linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%)",transform:"translateY(-2px)"},transition:"all 0.3s ease",color:"white"},children:[Object(k.jsx)(ne.a,{children:Object(k.jsx)(ae.a,{badgeContent:e.participants,color:"secondary",children:T(e.type||"location",e.subType)})}),Object(k.jsx)(re.a,{primary:e.name,secondary:Object(k.jsxs)(g.a,{component:"div",sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[Object(k.jsxs)(g.a,{component:"div",sx:{display:"flex",alignItems:"center",gap:.5},children:[Object(k.jsx)(me.a,{fontSize:"small"}),Object(k.jsxs)(j.a,{component:"span",variant:"caption",children:[e.participants||0," online"]})]}),void 0!==e.distance&&null!==e.distance&&Object(k.jsx)($.a,{label:"".concat(e.distance,"km"),size:"small",variant:"outlined",sx:{height:16,fontSize:"0.7rem",borderColor:"rgba(255,255,255,0.5)",color:"white"}})]})})]})},"neighborhood-".concat(R(e),"-").concat(t))))}),Object(k.jsx)(ie.a,{sx:{my:1,borderColor:"rgba(255,255,255,0.2)"}})]}),L.length>0&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(g.a,{sx:{p:2,pb:1},children:Object(k.jsxs)(j.a,{variant:"subtitle2",sx:{fontWeight:"bold",color:"white"},children:["\ud83c\udf89 Events (",L.length,")"]})}),Object(k.jsx)(ee.a,{dense:!0,children:L.map(((e,t)=>{var o,n,a,r;return Object(k.jsx)(te.a,{disablePadding:!0,children:Object(k.jsxs)(oe.a,{selected:E===R(e),onClick:()=>D(R(e)),sx:{borderRadius:1,mx:1,mb:.5,background:E===R(e)?"linear-gradient(135deg, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0.1) 100%)":"rgba(255,255,255,0.1)","&:hover":{background:"linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%)",transform:"translateY(-2px)"},transition:"all 0.3s ease",color:"white"},children:[Object(k.jsx)(ne.a,{children:Object(k.jsx)(ae.a,{badgeContent:e.participants,color:"secondary",children:Object(k.jsx)(he.a,{color:"secondary"})})}),Object(k.jsx)(re.a,{primary:(null===(o=e.event)||void 0===o?void 0:o.name)||e.name,secondary:Object(k.jsxs)(g.a,{children:[Object(k.jsx)(j.a,{variant:"caption",sx:{color:"rgba(255,255,255,0.7)"},children:(null===(n=e.event)||void 0===n?void 0:n.description)||e.description||"Event beschreibung"}),(null===(a=e.event)||void 0===a?void 0:a.startDate)&&Object(k.jsxs)(g.a,{sx:{display:"flex",alignItems:"center",gap:1,mt:.5},children:[Object(k.jsx)(pe.a,{fontSize:"small",color:"action"}),Object(k.jsx)(j.a,{variant:"caption",sx:{color:"rgba(255,255,255,0.7)"},children:(r=e.event.startDate,new Date(r).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}))})]})]})})]})},"event-".concat(R(e),"-").concat(t))}))}),Object(k.jsx)(ie.a,{sx:{my:1,borderColor:"rgba(255,255,255,0.2)"}})]}),B.length>0&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(g.a,{sx:{p:2,pb:1},children:Object(k.jsxs)(j.a,{variant:"subtitle2",sx:{fontWeight:"bold",color:"rgba(255,255,255,0.7)"},children:["\ud83c\udf10 Global (",B.length,")"]})}),Object(k.jsx)(ee.a,{dense:!0,children:B.map((e=>Object(k.jsx)(te.a,{disablePadding:!0,children:Object(k.jsxs)(oe.a,{selected:E===R(e),onClick:()=>D(R(e)),sx:{borderRadius:1,mx:1,mb:.5,background:E===R(e)?"linear-gradient(135deg, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0.1) 100%)":"rgba(255,255,255,0.1)","&:hover":{background:"linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%)",transform:"translateY(-2px)"},transition:"all 0.3s ease",color:"white"},children:[Object(k.jsx)(ne.a,{children:Object(k.jsx)(ae.a,{badgeContent:e.participants,color:"primary",children:Object(k.jsx)(ge.a,{color:"action"})})}),Object(k.jsx)(re.a,{primary:e.name,secondary:Object(k.jsxs)(j.a,{variant:"caption",sx:{color:"rgba(255,255,255,0.7)"},children:[e.participants," aktiv weltweit"]})})]})},R(e))))})]}),W.length>0&&0===P.length&&0===M.length&&0===U.length&&0===L.length&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(g.a,{sx:{p:2,pb:1},children:Object(k.jsxs)(j.a,{variant:"subtitle2",sx:{fontWeight:"bold",color:"white"},children:["\ud83d\udccd Alle Chat-R\xe4ume (",W.length,")"]})}),Object(k.jsx)(ee.a,{dense:!0,children:W.map(((e,t)=>Object(k.jsx)(te.a,{disablePadding:!0,children:Object(k.jsxs)(oe.a,{selected:E===R(e),onClick:()=>D(R(e)),sx:{borderRadius:1,mx:1,mb:.5,background:E===R(e)?"linear-gradient(135deg, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0.1) 100%)":"rgba(255,255,255,0.1)","&:hover":{background:"linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%)",transform:"translateY(-2px)"},transition:"all 0.3s ease",color:"white"},children:[Object(k.jsx)(ne.a,{children:Object(k.jsx)(ae.a,{badgeContent:e.participants,color:"primary",children:T(e.type,e.subType)})}),Object(k.jsx)(re.a,{primary:e.name,secondary:Object(k.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[Object(k.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:4},children:[Object(k.jsx)(me.a,{fontSize:"small"}),Object(k.jsxs)(j.a,{variant:"caption",sx:{display:"flex",alignItems:"center",gap:"4px"},children:[Object(k.jsx)(me.a,{fontSize:"small"}),Object(k.jsx)("span",{children:"0 online"})," "]})]}),void 0!==e.distance&&null!==e.distance&&Object(k.jsx)($.a,{label:"".concat(e.distance,"km"),size:"small",variant:"outlined",sx:{height:16,fontSize:"0.7rem",borderColor:"rgba(255,255,255,0.5)",color:"white"}})]})})]})},"all-".concat(R(e),"-").concat(t))))}),Object(k.jsx)(ie.a,{sx:{my:1,borderColor:"rgba(255,255,255,0.2)"}})]}),0===W.length&&!i&&Object(k.jsxs)(g.a,{sx:{p:3,textAlign:"center"},children:[Object(k.jsx)(j.a,{variant:"body2",sx:{color:"rgba(255,255,255,0.7)",mb:2},children:"\ud83c\udfe0 Keine Chat-R\xe4ume verf\xfcgbar"}),Object(k.jsx)(j.a,{variant:"caption",sx:{color:"rgba(255,255,255,0.5)"},children:"Standort wird verarbeitet oder Server-Problem"})]})]}),a&&Object(k.jsx)(ce.a,{color:"secondary",sx:{position:"absolute",bottom:16,right:16,zIndex:1e3},onClick:()=>u(!0),children:Object(k.jsx)(Oe.a,{})}),Object(k.jsxs)(se.a,{open:b,onClose:()=>u(!1),maxWidth:"sm",fullWidth:!0,children:[Object(k.jsx)(le.a,{children:Object(k.jsxs)(g.a,{sx:{display:"flex",alignItems:"center",gap:1},children:[Object(k.jsx)(fe.a,{color:"secondary"}),"Neues Event erstellen"]})}),Object(k.jsxs)(de.a,{children:[Object(k.jsx)(m.a,{fullWidth:!0,label:"Event Name",value:x,onChange:e=>p(e.target.value),margin:"normal",placeholder:"z.B. Rock am Ring 2025"}),Object(k.jsx)(m.a,{fullWidth:!0,label:"Beschreibung",value:O,onChange:e=>f(e.target.value),margin:"normal",multiline:!0,rows:3,placeholder:"Was ist geplant?"}),Object(k.jsx)(m.a,{fullWidth:!0,label:"Start",type:"datetime-local",value:y,onChange:e=>S(e.target.value),margin:"normal",InputLabelProps:{shrink:!0}}),Object(k.jsx)(m.a,{fullWidth:!0,label:"Ende",type:"datetime-local",value:w,onChange:e=>C(e.target.value),margin:"normal",InputLabelProps:{shrink:!0}})]}),Object(k.jsxs)(be.a,{children:[Object(k.jsx)(h.a,{onClick:()=>u(!1),children:"Abbrechen"}),Object(k.jsx)(h.a,{onClick:async()=>{try{await l({eventName:x,eventDescription:O,startDate:y,endDate:w}),u(!1),p(""),f(""),S(""),C("")}catch(e){console.error("Error creating event:",e)}},variant:"contained",color:"secondary",disabled:!x.trim(),children:"Event erstellen"})]})]})]})};var Ce,Ie,Ee=()=>{const{roomId:e}=Object(s.s)(),{messages:t,joinRoom:o,sendMessage:a,currentRoom:r}=ke(),[i,c]=Object(n.useState)(!0),[l,d]=Object(n.useState)("");Object(n.useEffect)((()=>{if(e&&e!==r){console.log("\ud83d\udeaa ChatRoom component: Joining room",e),c(!0),o(e);const t=setTimeout((()=>{c(!1)}),1e3);return()=>clearTimeout(t)}e===r&&c(!1)}),[e,r,o]);return i?Object(k.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",fontSize:"16px",color:"#666"},children:"Lade Chat-Raum..."}):Object(k.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[Object(k.jsx)("div",{style:{flex:1,overflowY:"auto",padding:"16px",backgroundColor:"#f5f5f5"},children:t&&t.length>0?t.map(((e,t)=>{var o;return Object(k.jsx)("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"12px"},children:Object(k.jsxs)("div",{style:{maxWidth:"70%",padding:"12px 16px",borderRadius:"18px",backgroundColor:"#E5E5EA",color:"black"},children:[Object(k.jsx)("div",{style:{fontSize:"12px",color:"#666"},children:(null===(o=e.user)||void 0===o?void 0:o.username)||e.username||"Unbekannt"}),Object(k.jsx)("div",{style:{fontSize:"14px"},children:e.content}),Object(k.jsx)("div",{style:{fontSize:"10px",color:"#999",marginTop:"4px",opacity:.7},children:new Date(e.createdAt||e.timestamp).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})})]})},e._id||e.id||t)})):Object(k.jsx)("div",{style:{textAlign:"center",color:"#999",marginTop:"50px",fontSize:"14px"},children:"Noch keine Nachrichten. Schreibe die erste Nachricht!"})}),Object(k.jsxs)("form",{onSubmit:e=>{e.preventDefault(),l.trim()&&(console.log("\ud83d\udce4 ChatRoom: Sending message:",l),a(l),d(""))},style:{display:"flex",padding:"16px",backgroundColor:"white",borderTop:"1px solid #e0e0e0"},children:[Object(k.jsx)("input",{type:"text",value:l,onChange:e=>d(e.target.value),placeholder:"Nachricht schreiben...",style:{flex:1,padding:"12px 16px",border:"1px solid #ddd",borderRadius:"20px",outline:"none",fontSize:"14px"}}),Object(k.jsx)("button",{type:"submit",disabled:!l.trim(),style:{marginLeft:"8px",padding:"12px 20px",backgroundColor:l.trim()?"#007AFF":"#ccc",color:"white",border:"none",borderRadius:"20px",cursor:l.trim()?"pointer":"not-allowed",fontSize:"14px"},children:"Senden"})]})]})},Re=o(28),De=o(273),Ae=o(230),Te=o(275),We=o(246),ze=o(247),Pe=o(248),Me=o(249),Le=o(47);const Be=Object(Le.c)(Ce||(Ce=Object(Re.a)(["\n  0% {\n    transform: scale(0);\n    opacity: 0;\n  }\n  50% {\n    transform: scale(0.5);\n    opacity: 0.7;\n  }\n  100% {\n    transform: scale(1);\n    opacity: 1;\n  }\n"]))),Ue=Object(Le.c)(Ie||(Ie=Object(Re.a)(["\n  0% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0.4); }\n  70% { box-shadow: 0 0 0 20px rgba(102, 126, 234, 0); }\n  100% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0); }\n"]))),Fe=Object(y.a)(H.a)((()=>({background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(248,250,252,0.98) 100%)",backdropFilter:"blur(20px)",borderBottom:"1px solid rgba(102, 126, 234, 0.1)",boxShadow:"0 8px 32px rgba(102, 126, 234, 0.15)",color:"#2d3748",height:56,"&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:"2px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}}))),Ne=Object(y.a)(V.a)((()=>({height:56,minHeight:56,paddingRight:80}))),_e=Object(y.a)(g.a)((()=>({width:32,height:32,borderRadius:"8px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:"14px",marginRight:12,boxShadow:"0 4px 16px rgba(102, 126, 234, 0.3)"}))),Ge=Object(y.a)(De.a)((()=>({width:64,height:64,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"3px solid rgba(255,255,255,0.9)",boxShadow:"0 8px 25px rgba(102, 126, 234, 0.4)",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"absolute",top:14,right:16,zIndex:1e3,fontSize:"1.5rem","&:hover":{transform:"scale(1.1)",animation:"".concat(Ue," 1.5s infinite")}}))),qe=Object(y.a)(g.a)((()=>({position:"fixed",top:0,right:0,left:0,bottom:0,zIndex:9999,pointerEvents:"none"}))),Je=Object(y.a)(g.a)((e=>{let{delay:t,active:o,angle:n}=e;const a="undefined"!==typeof window?window.innerWidth-48:300,r=n-45,i=a+110*Math.cos(r*Math.PI/180),c=46+110*Math.sin(r*Math.PI/180);return{width:48,height:48,borderRadius:"50%",background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(248,250,252,0.95) 100%)",backdropFilter:"blur(20px)",border:"2px solid rgba(102, 126, 234, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",pointerEvents:"auto",position:"absolute",left:"".concat(i-24,"px"),top:"".concat(c-24,"px"),transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",animation:o?"".concat(Be," 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55) ").concat(t,"s both"):"none",boxShadow:"0 8px 32px rgba(102, 126, 234, 0.2)",transformOrigin:"".concat(a-i+24,"px ").concat(46-c+24,"px"),"&:hover":{transform:"scale(1.1)",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",boxShadow:"0 12px 40px rgba(102, 126, 234, 0.4)"}}}));var Ye=e=>{var t,o;let{onMenuClick:a}=e;const{user:r}=w(),i=Object(s.q)(),[c,l]=Object(n.useState)(!1),d=e=>{l(!1),setTimeout((()=>{switch(e){case"profile":i("/profile");break;case"settings":i("/settings");break;case"info":console.log("Info modal \xf6ffnen")}}),300)};return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)(Fe,{position:"fixed",children:[Object(k.jsxs)(Ne,{children:[Object(k.jsx)(K.a,{edge:"start",color:"inherit",onClick:a,sx:{mr:2},children:Object(k.jsx)(We.a,{})}),Object(k.jsxs)(g.a,{sx:{display:"flex",alignItems:"center",flex:1},children:[Object(k.jsx)(_e,{children:"C"}),Object(k.jsx)(j.a,{variant:"h6",sx:{fontWeight:700,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",letterSpacing:"1px"},children:"CHATILO"})]})]}),Object(k.jsx)(Ge,{onClick:()=>{l(!c)},children:(null===r||void 0===r||null===(t=r.username)||void 0===t||null===(o=t.charAt(0))||void 0===o?void 0:o.toUpperCase())||"U"})]}),c&&Object(k.jsx)(Ae.a,{in:c,timeout:300,children:Object(k.jsx)(Te.a,{open:c,onClick:()=>l(!1),sx:{zIndex:9998,backgroundColor:"rgba(0,0,0,0.1)"}})}),c&&Object(k.jsxs)(qe,{children:[Object(k.jsx)(Je,{delay:.1,active:c,angle:225,onClick:()=>d("profile"),children:Object(k.jsx)(ze.a,{sx:{color:"#667eea",fontSize:20}})}),Object(k.jsx)(Je,{delay:.2,active:c,angle:180,onClick:()=>d("settings"),children:Object(k.jsx)(Pe.a,{sx:{color:"#667eea",fontSize:20}})}),Object(k.jsx)(Je,{delay:.3,active:c,angle:135,onClick:()=>d("info"),children:Object(k.jsx)(Me.a,{sx:{color:"#667eea",fontSize:20}})})]})]})};var He=()=>{const{roomId:e}=Object(s.s)(),t=Object(q.a)(),o=Object(J.a)(t.breakpoints.down("md")),[a,r]=Object(n.useState)(!1),[i,c]=Object(n.useState)(!1),l=()=>{r(!a)};return o?Object(k.jsxs)(g.a,{sx:{display:"flex",flexDirection:"column",height:"100vh"},children:[Object(k.jsx)(Ye,{onMenuClick:()=>c(!0)}),Object(k.jsx)(Y.a,{variant:"temporary",open:i,onClose:()=>c(!1),ModalProps:{keepMounted:!0},sx:{"& .MuiDrawer-paper":{width:300,background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)"}},children:Object(k.jsx)(we,{})}),Object(k.jsx)(g.a,{sx:{flex:1,display:"flex",flexDirection:"column",mt:"64px"},children:Object(k.jsx)(Ee,{})})]}):Object(k.jsxs)(g.a,{sx:{display:"flex",height:"100vh"},children:[o&&Object(k.jsx)(H.a,{position:"fixed",sx:{zIndex:1300},children:Object(k.jsxs)(V.a,{children:[Object(k.jsx)(K.a,{edge:"start",color:"inherit",onClick:l,sx:{mr:2},children:Object(k.jsx)(X.a,{})}),Object(k.jsx)(j.a,{variant:"h6",children:"Chatilo"})]})}),Object(k.jsx)(Y.a,{variant:o?"temporary":"permanent",open:!o||a,onClose:l,sx:{width:o?"100%":320,flexShrink:0,"& .MuiDrawer-paper":{width:o?"100%":320,boxSizing:"border-box",marginTop:o?"64px":0}},ModalProps:{keepMounted:!0},children:Object(k.jsx)(we,{})}),Object(k.jsx)(g.a,{component:"main",sx:{flexGrow:1,width:{md:"calc(100% - ".concat(320,"px)")},height:"100%",display:"flex",flexDirection:"column",marginTop:o?"64px":0},children:e?Object(k.jsx)(Ee,{}):Object(k.jsx)(g.a,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"text.secondary"},children:"W\xe4hle einen Chat-Raum aus"})})]})},Ve=o(263),Ke=o(251),Ze=o(252),Xe=o(253),Qe=o(254),$e=o(255),et=o(256);const tt=Object(y.a)(g.a)((e=>{let{theme:t}=e;return{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:t.spacing(2)}})),ot=Object(y.a)(u.a)((e=>{let{theme:t}=e;return{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",borderRadius:20,border:"2px solid rgba(255, 255, 255, 0.3)",padding:t.spacing(4),color:t.palette.text.primary,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)"}})),nt=Object(y.a)(g.a)((e=>{let{theme:t}=e;return{width:60,height:60,borderRadius:"12px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px auto",boxShadow:"0 8px 25px rgba(102, 126, 234, 0.4)"}})),at=Object(y.a)(j.a)((e=>{let{theme:t}=e;return{color:"white",fontSize:"28px",fontWeight:"bold"}})),rt=Object(y.a)(De.a)((e=>{let{theme:t}=e;return{width:120,height:120,marginBottom:t.spacing(2),border:"4px solid rgba(255, 255, 255, 0.9)",boxShadow:"0 8px 25px rgba(102, 126, 234, 0.3)",cursor:"pointer",position:"relative",transition:"all 0.3s ease","&:hover":{transform:"scale(1.05)",boxShadow:"0 12px 35px rgba(102, 126, 234, 0.5)"}}})),it=Object(y.a)(g.a)((e=>{let{theme:t}=e;return{position:"absolute",top:0,left:0,right:0,bottom:0,borderRadius:"50%",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,transition:"opacity 0.3s ease","&:hover":{opacity:1}}})),ct=Object(y.a)(m.a)((e=>{let{theme:t}=e;return{"& .MuiInputBase-root":{backgroundColor:"rgba(255, 255, 255, 0.8)",borderRadius:12},"& .MuiOutlinedInput-root":{"&:hover fieldset":{borderColor:"#667eea"},"&.Mui-focused fieldset":{borderColor:"#667eea"}}}}));var st=()=>{var e;const{user:t}=w(),o=Object(s.q)(),a=Object(n.useRef)(null),[r,i]=Object(n.useState)(!1),[c,l]=Object(n.useState)(null),[b,u]=Object(n.useState)({open:!1,message:"",severity:"success"}),[x,f]=Object(n.useState)({username:(null===t||void 0===t?void 0:t.username)||"",email:(null===t||void 0===t?void 0:t.email)||"",bio:(null===t||void 0===t?void 0:t.bio)||""}),v=()=>{var e;null===(e=a.current)||void 0===e||e.click()};return Object(k.jsxs)(tt,{children:[Object(k.jsx)(p.a,{maxWidth:"md",children:Object(k.jsxs)(ot,{elevation:0,children:[Object(k.jsx)(g.a,{sx:{mb:3},children:Object(k.jsx)(h.a,{startIcon:Object(k.jsx)(Ke.a,{}),onClick:()=>o("/chat"),sx:{background:"linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(255, 255, 255, 0.1) 100%)",color:"primary.main",fontWeight:600,borderRadius:3,px:3,py:1.5,"&:hover":{background:"linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(255, 255, 255, 0.2) 100%)",transform:"translateX(-5px)"},transition:"all 0.3s ease"},children:"Zur\xfcck zum Chat"})}),Object(k.jsxs)(g.a,{textAlign:"center",mb:4,children:[Object(k.jsx)(nt,{children:Object(k.jsx)(at,{children:"C"})}),Object(k.jsx)(j.a,{variant:"h3",sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",fontWeight:"bold",textAlign:"center",marginBottom:1},children:"Mein Profil"}),Object(k.jsx)(j.a,{variant:"h6",color:"text.secondary",sx:{fontWeight:500,opacity:.8},children:"Verwalte deine CHATILO Einstellungen"})]}),Object(k.jsx)("input",{type:"file",ref:a,style:{display:"none"},accept:"image/*",onChange:e=>{var t;const o=null===(t=e.target.files)||void 0===t?void 0:t[0];if(o){const e=new FileReader;e.onload=e=>{var t;l(null===(t=e.target)||void 0===t?void 0:t.result),u({open:!0,message:"Profilbild aktualisiert! Vergiss nicht zu speichern.",severity:"success"})},e.readAsDataURL(o)}}}),Object(k.jsxs)(g.a,{display:"flex",flexDirection:"column",alignItems:"center",mb:4,children:[Object(k.jsxs)(g.a,{sx:{position:"relative"},children:[Object(k.jsxs)(rt,{src:c||(null===t||void 0===t?void 0:t.avatar)||void 0,onClick:v,children:[null===t||void 0===t||null===(e=t.username)||void 0===e?void 0:e.charAt(0).toUpperCase(),Object(k.jsx)(it,{children:Object(k.jsx)(Ze.a,{sx:{color:"white",fontSize:30}})})]}),Object(k.jsx)(Q.a,{title:"Profilbild \xe4ndern",placement:"top",children:Object(k.jsx)(K.a,{onClick:v,sx:{position:"absolute",bottom:0,right:0,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",width:36,height:36,"&:hover":{background:"linear-gradient(135deg, #764ba2 0%, #667eea 100%)",transform:"scale(1.1)"}},children:Object(k.jsx)(Xe.a,{fontSize:"small"})})})]}),Object(k.jsx)(j.a,{variant:"h6",color:"primary",children:null===t||void 0===t?void 0:t.username}),Object(k.jsxs)(j.a,{variant:"body2",color:"text.secondary",children:["Mitglied seit ",new Date((null===t||void 0===t?void 0:t.createdAt)||Date.now()).toLocaleDateString("de-DE")]})]}),Object(k.jsx)(ie.a,{sx:{mb:3}}),Object(k.jsxs)(g.a,{mb:3,children:[Object(k.jsx)(j.a,{variant:"h6",gutterBottom:!0,color:"text.primary",children:"Pers\xf6nliche Informationen"}),Object(k.jsx)(g.a,{mb:2,children:Object(k.jsx)(m.a,{fullWidth:!0,label:"Benutzername",value:r?x.username:(null===t||void 0===t?void 0:t.username)||"",onChange:e=>f(Object(d.a)(Object(d.a)({},x),{},{username:e.target.value})),disabled:!r,variant:r?"outlined":"filled",sx:{"& .MuiInputBase-root":{backgroundColor:r?"background.paper":"rgba(0,0,0,0.05)"}}})}),Object(k.jsx)(g.a,{mb:2,children:Object(k.jsx)(m.a,{fullWidth:!0,label:"E-Mail",value:r?x.email:(null===t||void 0===t?void 0:t.email)||"",onChange:e=>f(Object(d.a)(Object(d.a)({},x),{},{email:e.target.value})),disabled:!r,variant:r?"outlined":"filled",sx:{"& .MuiInputBase-root":{backgroundColor:r?"background.paper":"rgba(0,0,0,0.05)"}}})}),Object(k.jsx)(g.a,{mb:2,children:Object(k.jsx)(ct,{fullWidth:!0,multiline:!0,rows:3,label:"\xdcber mich",placeholder:"Erz\xe4hle etwas \xfcber dich... (max. 200 Zeichen)",value:r?x.bio:(null===t||void 0===t?void 0:t.bio)||"",onChange:e=>{e.target.value.length<=200&&f(Object(d.a)(Object(d.a)({},x),{},{bio:e.target.value}))},disabled:!r,variant:r?"outlined":"filled",helperText:r?"".concat(x.bio.length,"/200 Zeichen"):"",sx:{"& .MuiInputBase-root":{backgroundColor:r?"background.paper":"rgba(0,0,0,0.05)"}}})})]}),Object(k.jsx)(ie.a,{sx:{mb:3}}),Object(k.jsx)(g.a,{display:"flex",justifyContent:"center",gap:2,children:r?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(h.a,{startIcon:Object(k.jsx)($e.a,{}),onClick:async()=>{try{console.log("Speichere Profildaten:",x,c),u({open:!0,message:"Profil erfolgreich aktualisiert!",severity:"success"}),i(!1)}catch(e){u({open:!0,message:"Fehler beim Speichern des Profils.",severity:"error"})}},variant:"contained",sx:{background:"linear-gradient(135deg, #4ade80 0%, #22c55e 100%)",borderRadius:3,px:4,py:1.5,"&:hover":{background:"linear-gradient(135deg, #22c55e 0%, #4ade80 100%)",transform:"translateY(-2px)"}},children:"Speichern"}),Object(k.jsx)(h.a,{startIcon:Object(k.jsx)(et.a,{}),onClick:()=>{i(!1),f({username:(null===t||void 0===t?void 0:t.username)||"",email:(null===t||void 0===t?void 0:t.email)||"",bio:(null===t||void 0===t?void 0:t.bio)||""}),l(null)},variant:"outlined",sx:{borderColor:"#ef4444",color:"#ef4444",borderRadius:3,px:4,py:1.5,"&:hover":{backgroundColor:"#ef4444",color:"white",transform:"translateY(-2px)"}},children:"Abbrechen"})]}):Object(k.jsx)(h.a,{startIcon:Object(k.jsx)(Qe.a,{}),onClick:()=>{i(!0)},variant:"contained",sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:3,px:4,py:1.5,"&:hover":{background:"linear-gradient(135deg, #764ba2 0%, #667eea 100%)",transform:"translateY(-2px)"}},children:"Profil bearbeiten"})})]})}),Object(k.jsx)(Ve.a,{open:b.open,autoHideDuration:4e3,onClose:()=>u(Object(d.a)(Object(d.a)({},b),{},{open:!1})),children:Object(k.jsx)(O.a,{onClose:()=>u(Object(d.a)(Object(d.a)({},b),{},{open:!1})),severity:b.severity,sx:{borderRadius:2},children:b.message})})]})},lt=o(283),dt=o(268),bt=o(130),gt=o.n(bt),jt=o(131),ut=o.n(jt),ht=o(132),xt=o.n(ht),mt=o(134),pt=o.n(mt),Ot=o(133),ft=o.n(Ot);const vt=Object(y.a)(B.a)((e=>{let{theme:t}=e;return{background:"linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(248,250,252,0.9) 100%)",backdropFilter:"blur(10px)",borderRadius:20,border:"1px solid rgba(102, 126, 234, 0.1)",boxShadow:"0 8px 32px rgba(102, 126, 234, 0.1)",marginBottom:t.spacing(3)}})),yt=Object(y.a)(h.a)((e=>{let{theme:t}=e;return{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",borderRadius:12,padding:"12px 24px",fontWeight:600,textTransform:"none","&:hover":{background:"linear-gradient(135deg, #764ba2 0%, #667eea 100%)",transform:"translateY(-2px)",boxShadow:"0 6px 20px rgba(102, 126, 234, 0.4)"}}}));var kt=()=>{const e=Object(s.q)(),[t,o]=Object(n.useState)({locationEnabled:!0,notifications:!0,darkMode:!1,privateProfile:!1}),[a,r]=Object(n.useState)("idle"),i=e=>t=>{o((o=>Object(d.a)(Object(d.a)({},o),{},{[e]:t.target.checked})))};return Object(k.jsx)(g.a,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",p:3,overflow:"auto"},children:Object(k.jsxs)(g.a,{sx:{maxWidth:800,mx:"auto"},children:[Object(k.jsxs)(g.a,{sx:{display:"flex",alignItems:"center",mb:4},children:[Object(k.jsx)(h.a,{startIcon:Object(k.jsx)(gt.a,{}),onClick:()=>e("/chat"),sx:{mr:2,color:"primary.main"},children:"Zur\xfcck"}),Object(k.jsx)(j.a,{variant:"h4",sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",fontWeight:700},children:"Einstellungen"})]}),Object(k.jsx)(vt,{children:Object(k.jsxs)(U.a,{sx:{p:0},children:[Object(k.jsx)(j.a,{variant:"h6",sx:{p:3,pb:1},children:"App-Einstellungen"}),Object(k.jsxs)(ee.a,{children:[Object(k.jsxs)(te.a,{children:[Object(k.jsx)(ne.a,{children:Object(k.jsx)(ut.a,{color:"primary"})}),Object(k.jsx)(re.a,{primary:"Standort-Dienste",secondary:"Erm\xf6glicht lokale Chat-R\xe4ume"}),Object(k.jsx)(lt.a,{children:Object(k.jsx)(dt.a,{checked:t.locationEnabled,onChange:i("locationEnabled"),color:"primary"})})]}),Object(k.jsx)(ie.a,{}),Object(k.jsxs)(te.a,{children:[Object(k.jsx)(ne.a,{children:Object(k.jsx)(xt.a,{color:"primary"})}),Object(k.jsx)(re.a,{primary:"Push-Benachrichtigungen",secondary:"Erhalte Nachrichten auch wenn die App geschlossen ist"}),Object(k.jsx)(lt.a,{children:Object(k.jsx)(dt.a,{checked:t.notifications,onChange:i("notifications"),color:"primary"})})]}),Object(k.jsx)(ie.a,{}),Object(k.jsxs)(te.a,{children:[Object(k.jsx)(ne.a,{children:Object(k.jsx)(ft.a,{color:"primary"})}),Object(k.jsx)(re.a,{primary:"Dunkles Design",secondary:"Aktiviere den Dark Mode"}),Object(k.jsx)(lt.a,{children:Object(k.jsx)(dt.a,{checked:t.darkMode,onChange:i("darkMode"),color:"primary"})})]}),Object(k.jsx)(ie.a,{}),Object(k.jsxs)(te.a,{children:[Object(k.jsx)(ne.a,{children:Object(k.jsx)(pt.a,{color:"primary"})}),Object(k.jsx)(re.a,{primary:"Privates Profil",secondary:"Nur Freunde k\xf6nnen dein Profil sehen"}),Object(k.jsx)(lt.a,{children:Object(k.jsx)(dt.a,{checked:t.privateProfile,onChange:i("privateProfile"),color:"primary"})})]})]})]})}),Object(k.jsxs)(g.a,{sx:{textAlign:"center"},children:["saved"===a&&Object(k.jsx)(O.a,{severity:"success",sx:{mb:2},children:"Einstellungen erfolgreich gespeichert!"}),Object(k.jsx)(yt,{onClick:async()=>{r("saving");try{await new Promise((e=>setTimeout(e,1e3))),r("saved"),setTimeout((()=>r("idle")),3e3)}catch(e){r("error")}},disabled:"saving"===a,size:"large",children:"saving"===a?"Speichere...":"Einstellungen speichern"})]})]})})};var St=e=>{let{children:t}=e;const{user:o,loading:n}=w();return n?Object(k.jsx)(g.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%)"},children:Object(k.jsx)(v.a,{size:60,sx:{color:"white"}})}):o?Object(k.jsx)(k.Fragment,{children:t}):Object(k.jsx)(s.a,{to:"/login",replace:!0})},wt=o(136),Ct=o(257);const It=Object(wt.a)({palette:{primary:{main:"#1976d2"},secondary:{main:"#dc004e"}}}),Et="ABSOLUTE_FINAL_V6_"+Date.now(),Rt=(new Date).toISOString();var Dt=function(){if(console.log("\ud83d\udd27 DEBUG: App component initializing..."),Object(n.useEffect)((()=>(console.log("\ud83d\udd27 DEBUG: App useEffect - Component mounted"),console.log("   Window dimensions:",{width:window.innerWidth,height:window.innerHeight}),console.log("   User Agent:",navigator.userAgent),console.log("   Local Storage keys:",Object.keys(localStorage)),console.log("   Session Storage keys:",Object.keys(sessionStorage)),()=>{console.log("\ud83d\udd27 DEBUG: App useEffect - Component will unmount")})),[]),console.log("\ud83d\udd27 DEBUG: App component rendering..."),console.log("\ud83c\udd98\ud83c\udd98\ud83c\udd98\ud83c\udd98\ud83c\udd98 FINAL EMERGENCY REBUILD!!! \ud83c\udd98\ud83c\udd98\ud83c\udd98\ud83c\udd98\ud83c\udd98"),console.log("\ud83d\udd25 FINAL VERSION: ".concat(Et)),console.log("\u23f0 TIMESTAMP: ".concat(Rt)),console.log("\ud83d\udeaa ROOM ROUTE /chat/:roomId ABSOLUTELY MUST WORK NOW!"),console.log("\u2705 ALL ROUTES: /login, /register, /chat, /chat/:roomId, /profile, /settings"),!Et||Et.length<20)throw console.error("\ud83d\udca5\ud83d\udca5\ud83d\udca5 OLD APP VERSION DETECTED - CRITICAL ERROR"),new Error("CRITICAL: OLD APP VERSION STILL LOADING!");return Object(k.jsx)(C,{children:Object(k.jsxs)(l.a,{theme:It,children:[Object(k.jsx)(Ct.a,{}),Object(k.jsx)(c.a,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:Object(k.jsxs)(s.d,{children:[Object(k.jsx)(s.b,{path:"/login",element:Object(k.jsx)(L,{})}),Object(k.jsx)(s.b,{path:"/register",element:Object(k.jsx)(G,{})}),Object(k.jsx)(s.b,{path:"/chat",element:Object(k.jsx)(St,{children:Object(k.jsx)(Se,{children:Object(k.jsx)(He,{})})})}),Object(k.jsx)(s.b,{path:"/chat/:roomId",element:Object(k.jsx)(St,{children:Object(k.jsx)(Se,{children:Object(k.jsx)(He,{})})})}),Object(k.jsx)(s.b,{path:"/profile",element:Object(k.jsx)(St,{children:Object(k.jsx)(st,{})})}),Object(k.jsx)(s.b,{path:"/settings",element:Object(k.jsx)(St,{children:Object(k.jsx)(kt,{})})}),Object(k.jsx)(s.b,{path:"/",element:Object(k.jsx)(s.a,{to:"/chat",replace:!0})})]})})]})})};i.a.createRoot(document.getElementById("root")).render(Object(k.jsx)(a.a.StrictMode,{children:Object(k.jsx)(Dt,{})}))}},[[173,1,2]]]);
//# sourceMappingURL=main.4f8ee965.chunk.js.map